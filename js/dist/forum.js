(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["forum/app"];var o=t.n(e);const r=flarum.core.compat["common/extend"],n=flarum.core.compat["forum/utils/UserControls"];var a=t.n(n);const s=flarum.core.compat["common/components/Button"];var i=t.n(s);function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}const c=flarum.core.compat["common/components/Modal"];var l=t.n(c);const p=flarum.core.compat["common/utils/Stream"];var d=t.n(p),f=function(t){function e(){return t.apply(this,arguments)||this}var r,n;n=t,(r=e).prototype=Object.create(n.prototype),r.prototype.constructor=r,u(r,n);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.user=this.attrs.user,this.groupId=d()(""),this.date=d()(""),this.days=d()("")},a.className=function(){return"ExpirationModal Modal--small"},a.title=function(){return"è®¾ç½®ç¾¤ç»„è¿‡æœŸæ—¶é—´"},a.content=function(){var t=this;return m("div",{className:"Modal-body"},m("div",{className:"Form-group"},m("label",null,"é€‰æ‹©ç¾¤ç»„"),m("select",{className:"FormControl",value:this.groupId(),onchange:function(e){return t.groupId(e.target.value)}},m("option",{value:"",disabled:!0,selected:!0},"è¯·é€‰æ‹©..."),o().store.all("groups").filter(function(t){return"2"!==t.id()&&"3"!==t.id()}).map(function(t){return m("option",{value:t.id()},t.namePlural())}))),m("div",{className:"Form-group"},m("label",null,"è¿‡æœŸæ—¶é•¿ (å¤©æ•°)"),m("input",{type:"number",className:"FormControl",placeholder:"ä¾‹å¦‚: 30",value:this.days(),oninput:function(e){return t.syncDate(e.target.value)}})),m("div",{className:"Form-group"},m("label",null,"è¿‡æœŸæ—¥æœŸ (è‡ªåŠ¨è®¡ç®—)"),m("input",{type:"date",className:"FormControl",value:this.date(),onchange:function(e){return t.syncDays(e.target.value)}})),m("div",{className:"Form-group"},i().component({type:"submit",className:"Button Button--primary",disabled:!this.groupId()||!this.date()},"ä¿å­˜è®¾ç½®")))},a.syncDate=function(t){if(this.days(t),t){var e=new Date;e.setDate(e.getDate()+parseInt(t));var o=e.toISOString().split("T")[0];this.date(o)}else this.date("")},a.syncDays=function(t){if(this.date(t),t){var e=new Date,o=new Date(t)-e,r=Math.ceil(o/864e5);this.days(r>0?r:0)}else this.days("")},a.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0,o().request({method:"POST",url:o().forum.attribute("apiUrl")+"/group-expiration",body:{userId:this.user.id(),groupId:this.groupId(),expirationDate:this.date()}}).then(function(){e.hide(),o().alerts.show({type:"success"},"è®¾ç½®æˆåŠŸï¼ç”¨æˆ·å·²åŠ å…¥ç¾¤ç»„å¹¶è®¾å®šäº†è¿‡æœŸæ—¶é—´ã€‚"),window.location.reload()}).catch(function(){e.loading=!1,m.redraw()})},e}(l());o().initializers.add("hertz-dev-group-expiration",function(){(0,r.extend)(a(),"userControls",function(t,e){var r=o().session.user;r&&"function"!=typeof r.can?console.error("ğŸ˜± ä¸¥é‡é”™è¯¯ï¼šå½“å‰ç”¨æˆ·å¯¹è±¡ä¸¢å¤±äº† Model æ–¹æ³•ï¼",r):r&&r.can("hertz-dev.group-expiration.edit")&&t.add("expiration",i().component({icon:"fas fa-clock",onclick:function(){return o().modal.show(f,{user:e})}},"è®¾ç½®ç¾¤ç»„è¿‡æœŸæ—¶é—´"))})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map